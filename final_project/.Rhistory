)
# merge with cps
# clean cps
atus_cps <- raw_atus_cps %>%
select(tucaseid, prtage, pesex)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
View(atus_act)
View(atus_cps)
View(raw_atus_act)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"day_dur" = tuactdur24,
"cum_dur" = tucumdur24)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("case_id" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"day_dur" = tuactdur24)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("case" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"min" = tuactdur24)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("case" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# only activities related to technology and attention
atus_act %>%
filter(actv_code %in% codes) %>%
group_by(respondent, actv_code) %>%
summarise(tot_min = sum(minutes))
atus_act %>%
filter(actv_code %in% codes)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
atus_act %>%
group_by(respondent, actv_code) %>%
summarise(tot_min = sum(minutes))
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes) %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes))
atus_act <- actus_act %>%
filter(actv_code %in% codes)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# combine times for multiple instances of single activity
atus_act <- atus_act %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes))
atus_act %>%
pivot_wider(names_from = actv_code, values_from = minutes)
atus_act <- atus_act %>%
pivot_wider(names_from = actv_code, values_from = minutes)
# filter activities
codes <- c("120303", # television and movies (not religious)
"120304", # television (religious)
"120305", # listening to the radio
"120306", # listening to/playing music (not radio)
"120307", # playing games
"120308", # computer use for leisure
"160101", # telephone calls to/from family members
"160102" # telephone calls to/from friends, neighbors, acquantances
)
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# combine times for multiple instances of single activity
atus_act <- atus_act %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes) %>%
rename("tv_movies" = "120303",
"tv_relig" = "120304",
"radio" = "120305",
"music" = "120306",
"games" = "120307",
"computer" = "120308",
"phone_family" = "160101",
"phone_friends" = "160102")
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# filter activities
codes <- c("120303", # television and movies (not religious)
"120304", # television (religious)
"120305", # listening to the radio
"120306", # listening to/playing music (not radio)
"120307", # playing games
"120308", # computer use for leisure
"160101", # telephone calls to/from family members
"160102" # telephone calls to/from friends, neighbors, acquantances
)
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# combine times for multiple instances of single activity
atus_act <- atus_act %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes) %>%
rename("tv_movies" = "120303",
"tv_relig" = "120304",
"radio" = "120305",
"music" = "120306",
"games" = "120307",
"computer" = "120308",
"phone_family" = "160101",
"phone_friends" = "160102")
View(atus_cps)
View(raw_atus_act)
library(tidyverse)
options(scipen = 9999)
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project"
raw_atus_act <- read_csv(file.path(path, "/data-raw/atusact.csv"))
?tibble()
codes = c("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102")
activities <- tibble(
names = c("TV and movies", "TV (religious)", "Listening to radio",
"Listening to music", "Playing games", "Computer use (for leisure)",
"Telephone with family", "Telephone with friends"),
codes = c("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102")
)
View(activities)
activities <- tibble(
name = c("TV and movies", "TV (religious)", "Listening to radio",
"Listening to music", "Playing games", "Computer use (for leisure)",
"Telephone with family", "Telephone with friends"),
code = c("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102")
)
View(activities)
# clean act
df <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# filter activities
df <- df %>%
filter(actv_code %in% activities$code)
View(df)
df %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes)
# combine times for multiple instances of single activity
df <- df %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes)
replace_colnames <- activities$name %in% names(df)
names(dfd)
names(df)
replace_colnames <- activities$code %in% names(df)
df %>%
select("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102")
df %>%
select("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102")
df %>%
select("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102") %>%
top_n(8)
df %>%
select("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102") %>%
top_n(8) %>%
rename_with(~activities$name[replace_colnames], activities$code[replace_colnames])
df <- df %>%
select("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102") %>%
top_n(8) %>%
rename_with(~activities$name[replace_colnames], activities$code[replace_colnames])
df <- df %>%
select("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102") %>%
rename_with(~activities$name[replace_colnames], activities$code[replace_colnames])
df <- df %>%
select("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102") %>%
top_n(8) %>%
rename_with(~activities$name[replace_colnames], activities$code[replace_colnames])
# separate respondent col into years
activity <- activity %>%
separate(respondent, into = c("year", "respondent"), sep = 4)
# separate respondent col into years
df <- df %>%
separate(respondent, into = c("year", "respondent"), sep = 4)
averages <- df %>%
group_by(year) %>%
summarise(tv_movies = mean(tv_movies, na.rm = TRUE),
tv_relig = mean(tv_relig, na.rm = TRUE),
radio = mean(radio, na.rm = TRUE),
music = mean(music, na.rm = TRUE),
games = mean(games, na.rm = TRUE),
computer = mean(computer, na.rm = TRUE),
phone_family = mean(phone_family, na.rm = TRUE),
phone_friends = mean(phone_friends, na.rm = TRUE)) %>%
pivot_longer(c(tv_movies, tv_relig, radio, music, games, computer,
phone_family, phone_friends),
names_to = "activity", values_to = "avg_min")
averages <- df %>%
group_by(year) %>%
summarise('TV and movies' = mean(), na.rm = TRUE)
averages <- df %>%
group_by(year) %>%
summarise('TV and movies' = mean(""), na.rm = TRUE)
View(averages)
# clean act
df <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# filter activities
df <- df %>%
filter(actv_code %in% activities$code)
# combine times for multiple instances of single activity
df <- df %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes)
# separate respondent col into years
df <- df %>%
separate(respondent, into = c("year", "respondent"), sep = 4)
a
averages <- df %>%
group_by(year) %>%
summarise('120301' = mean('120301'), na.rm = TRUE,
'120302' = mean('120302'), na.rm = TRUE,
'120303' = mean('120303'), na.rm = TRUE,
'120304' = mean('120304'), na.rm = TRUE,
'120305' = mean('120305'), na.rm = TRUE,
'120306' = mean('120306'), na.rm = TRUE,
'160101' = mean('160101'), na.rm = TRUE,
'160102' = mean('160102'), na.rm = TRUE) %>%
pivot_longer(c('120301', '120302', '120303', '120304', '120305', '120306', '160101', '160102'),
names_to = "activity", values_to = "avg_min")
View(averages)
# separate respondent col into years
df <- df %>%
separate(respondent, into = c("year", "respondent"), sep = 4)
# clean act
df <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# filter activities
df <- df %>%
filter(actv_code %in% activities$code)
# combine times for multiple instances of single activity
df <- df %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes)
# separate respondent col into years
df <- df %>%
separate(respondent, into = c("year", "respondent"), sep = 4)
df %>%
group_by(year) %>%
summarise('120303' = mean('120303'), na.rm = TRUE,
'120304' = mean('120304'), na.rm = TRUE,
'120305' = mean('120305'), na.rm = TRUE,
'120306' = mean('120306'), na.rm = TRUE,
'120307' = mean('120307'), na.rm = TRUE,
'120308' = mean('120308'), na.rm = TRUE,
'160101' = mean('160101'), na.rm = TRUE,
'160102' = mean('160102'), na.rm = TRUE) %>%
pivot_longer(c('120301', '120302', '120303', '120304', '120305', '120306', '160101', '160102'),
names_to = "activity", values_to = "avg_min")
df %>%
group_by(year)
df %>%
group_by(year) %>%
summarise('120303' = mean('120303', na.rm = TRUE),
'120304' = mean('120304', na.rm = TRUE),
'120305' = mean('120305', na.rm = TRUE),
'120306' = mean('120306', na.rm = TRUE),
'120307' = mean('120307', na.rm = TRUE),
'120308' = mean('120308', na.rm = TRUE),
'160101' = mean('160101', na.rm = TRUE),
'160102' = mean('160102', na.rm = TRUE)) %>%
pivot_longer(c('120301', '120302', '120303', '120304', '120305', '120306', '160101', '160102'),
names_to = "activity", values_to = "avg_min")
df %>%
group_by(year) %>%
summarise('120303' = mean('120303', na.rm = TRUE),
'120304' = mean('120304', na.rm = TRUE),
'120305' = mean('120305', na.rm = TRUE),
'120306' = mean('120306', na.rm = TRUE),
'120307' = mean('120307', na.rm = TRUE),
'120308' = mean('120308', na.rm = TRUE),
'160101' = mean('160101', na.rm = TRUE),
'160102' = mean('160102', na.rm = TRUE)) %>%
pivot_longer(c('120303', '120304', '120305', '120306', '120307', '120308', '160101', '160102'),
names_to = "activity", values_to = "avg_min")
df %>%
group_by(year) %>%
summarise('120303' = mean('120303', na.rm = TRUE),
'120304' = mean('120304', na.rm = TRUE),
'120305' = mean('120305', na.rm = TRUE),
'120306' = mean('120306', na.rm = TRUE),
'120307' = mean('120307', na.rm = TRUE),
'120308' = mean('120308', na.rm = TRUE),
'160101' = mean('160101', na.rm = TRUE),
'160102' = mean('160102', na.rm = TRUE))
df %>%
group_by(year) %>%
summarise('120303' = mean('120303', na.rm = TRUE))
df %>%
group_by(year) %>%
summarise('120303' = mean('120303', na.rm = TRUE),
'120304' = mean('120304', na.rm = TRUE),
'120305' = mean('120305', na.rm = TRUE),
'120306' = mean('120306', na.rm = TRUE),
'120307' = mean('120307', na.rm = TRUE),
'120308' = mean('120308', na.rm = TRUE),
'160101' = mean('160101', na.rm = TRUE),
'160102' = mean('160102', na.rm = TRUE)) %>%
pivot_longer(c('120303', '120304', '120305', '120306', '120307', '120308', '160101', '160102'),
names_to = "activity", values_to = "avg_min")
df %>%
group_by(year) %>%
summarise(x = mean('120303', na.rm = TRUE))
?mean()
df %>%
group_by(year) %>%
summarise(n = n())
df %>%
group_by(year) %>%
summarise(n = n(),
mean = mean('120303', na.rm = TRUE))
df %>%
group_by(year) %>%
summarise(n = n(),
mean = mean('120303', na.rm = false))
df$x <- df$'120303'
summarise(mean = mean(x, na.rm = TRUE)
df %>%
group_by(year) %>%
summarise(mean = mean(x, na.rm = TRUE))
library(tidyverse)
options(scipen = 9999)
setwd("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project")
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project"
raw_adoption <- read_csv(file.path(path, "/data-raw/technology-adoption-by-households-in-the-united-states.csv"))
View(raw_adoption)
raw_adoption <- head(raw_adoption, -2)
technologies <- tibble(
name = c('Amazon Prime users', 'Cable TV', 'Cellular phone' ' Colour TV',
technologies <- tibble(
name = c('Amazon Prime users', 'Cable TV', 'Cellular phone' 'Colour TV',
technologies <- tibble(
name = c('Amazon Prime users', 'Cable TV', 'Cellular phone', 'Colour TV',
'Computer', 'Ebook reader', 'Households with only mobile phones(no landlines)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media usage', 'Tablet', 'Television', 'Videocasette recorder')
)
View(technologies)
technologies <- tibble(
name = c('Amazon Prime users', 'Cable TV', 'Cellular phone', 'Colour TV',
'Computer', 'Ebook reader', 'Households with only mobile phones (no landlines)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media usage', 'Tablet', 'Television', 'Videocasette recorder')
)
raw_adoption %>%
select(%in% technologies$name)
raw_adoption %>%
select(names() %in% technologies$name)
raw_adoption %>%
select(names(raw_adoption) %in% technologies$name)
View(raw_adoption)
raw_adoption$item <- select(names(raw_adoption %in% technologies$name))
raw_adoption$item <- select(names(raw_adoption) %in% technologies$name)
names(raw_adoption)
raw_adoption %>%
filter(item %in% technologies$name)
raw_adoption %>%
filter(item %in% technologies$name) %>%
rename('technology' = item)
raw_adoption %>%
filter(item %in% technologies$name) %>%
rename('technology' = item) %>%
select(technology, year, share)
df <- raw_adoption %>%
filter(item %in% technologies$name) %>%
rename('technology' = item) %>%
select(technology, year, share)
# clean
df <- raw_adoption %>%
filter(item %in% technologies$name) %>%
rename('technology' = item) %>%
select(technology, year, share)
View(df)
activities <- tibble(
name = c("TV and movies", "TV (religious)", "Listening to radio",
"Listening to music", "Playing games", "Computer use (for leisure)",
"Telephone with family", "Telephone with friends"),
code = c("120303", "120304", "120305", "120306", "120307", "120308", "160101", "160102")
)
View(technologies)
View(activities)
# codebook
technologies <- tibble(
name_og = c('Amazon Prime users', 'Cable TV', 'Cellular phone', 'Colour TV',
'Computer', 'Ebook reader', 'Households with only mobile phones (no landlines)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media usage', 'Tablet', 'Television', 'Videocasette recorder'),
name_new = c('Amazon Prime', 'Cable TV', 'Cell phone', 'Color TV',
'Computer', 'Ebook reader', 'Cell phone only (no landline)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media', 'Tablet', 'TV', 'Videocasette recorder'),
)
# codebook
technologies <- tibble(
name_old = c('Amazon Prime users', 'Cable TV', 'Cellular phone', 'Colour TV',
'Computer', 'Ebook reader', 'Households with only mobile phones (no landlines)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media usage', 'Tablet', 'Television', 'Videocasette recorder'),
name_new = c('Amazon Prime', 'Cable TV', 'Cell phone', 'Color TV',
'Computer', 'Ebook reader', 'Cell phone only (no landline)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media', 'Tablet', 'TV', 'Videocasette recorder'),
)
# codebook
technologies <- tibble(
name_og= c('Amazon Prime users', 'Cable TV', 'Cellular phone', 'Colour TV',
'Computer', 'Ebook reader', 'Households with only mobile phones (no landlines)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media usage', 'Tablet', 'Television', 'Videocasette recorder'),
name_new = c('Amazon Prime', 'Cable TV', 'Cell phone', 'Color TV',
'Computer', 'Ebook reader', 'Cell phone only (no landline)',
'Internet', 'Landline', 'Microcomputer', 'Podcasting', 'Radio',
'Social media', 'Tablet', 'TV', 'Videocasette recorder'),
)
# codebook
technologies <- tibble(
name_og = c('Cable TV', 'Cellular phone', 'Colour TV', 'Computer', 'Ebook reader',
'Households with only mobile phones (no landlines)', 'Internet',
'Landline', 'Podcasting', 'Radio', 'Social media usage', 'Tablet',
'Television', 'Videocasette recorder'),
name_new = c('Cable TV', 'Cell phone', 'Color TV', 'Computer', 'Ebook reader',
'Cell phone only (no landline)', 'Internet', 'Landline', 'Podcasting',
'Radio', 'Social media', 'Tablet', 'TV', 'Videocasette recorder'),
)
# clean
df <- raw_adoption %>%
filter(item %in% technologies$name_og) %>%
rename('technology' = item) %>%
select(technology, year, share)
# replace column names
df %>%
mutate(technology = technologies[as.character(name_new)])
# replace column names
df %>%
mutate(technology = technologies[as.character('name_new')])
?replace()
# replace column names
?recode()
# replace column names
df$technology <- recode(df$technology, technologies$name_new)
# replace column names
df %>%
mutate(technology = recode(technology,!!! technologies$name_new))
# replace column names
df %>%
mutate(technology = recode(technology,!!! technologies$name_og))
df$share <- as.integer(df$share)
# clean
df <- raw_adoption %>%
filter(item %in% technologies$name_og) %>%
rename('technology' = item) %>%
mutate(share = as.integer(share)) %>%
select(technology, year, share)
# write csv
write_csv(df, 'data-final/adoption.csv')
