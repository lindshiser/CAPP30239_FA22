mutate(pct_change = ((yearly_thm - lag(yearly_thm)) / yearly_thm) * 100)
df_gas_hi <- df_gas_hi %>%
mutate(pct_change = ((yearly_thm - lag(yearly_thm)) / yearly_thm) * 100)
df_elec_low <- df_elec_low %>%
mutate(pct_change = ((yearly_thm - lag(yearly_thm)) / yearly_thm) * 100)
df_elec_low <- df_elec_low %>%
mutate(pct_change = ((yearly_kwh - lag(yearly_kwh)) / yearly_kwh) * 100)
df_gas_med <- df_gas_med %>%
mutate(pct_change = ((yearly_thm - lag(yearly_thm)) / yearly_thm) * 100)
df_gas_hi <- df_gas_hi %>%
mutate(pct_change = ((yearly_thm - lag(yearly_thm)) / yearly_thm) * 100)
df_elec_low <- df_elec_low %>%
mutate(pct_change = ((yearly_kwh - lag(yearly_kwh)) / yearly_kwh) * 100)
df_elec_med <- df_elec_med %>%
mutate(pct_change = ((yearly_kwh - lag(yearly_kwh)) / yearly_kwh) * 100)
perc_change_energy <- c(df_gas_med, df_gas_hi)
perc_change_energy <- c(df_gas_med, df_gas_hi, df_elec_low, df_elec_med)
View(perc_change_energy)
perc_change_energy <- list("gas_med" = df_gas_med,
"gas_high" = df_gas_hi,
"elec_low" = df_elec_low
"elec_med" = df_elec_med)
perc_change_energy <- list("gas_med" = df_gas_med,
"gas_high" = df_gas_hi,
"elec_low" = df_elec_low,
"elec_med" = df_elec_med)
View(perc_change_energy)
View(perc_change_energy[["gas_med"]])
View(perc_change_energy)
# store tibbles in list
perc_changes <- list("gas_med" = df_gas_med,
"gas_high" = df_gas_hi,
"elec_low" = df_elec_low,
"elec_med" = df_elec_med)
View(df_elec_low)
# calculate perc change in energy usage, by EL, for each draw pattern
df_gas_med <- df_gas_med %>%
mutate(pct_change = ((yearly_thm - first(yearly_thm)) / yearly_thm) * 100)
View(df_gas_med)
df_gas_med <- df_gas_med %>%
mutate(pct_change = ((yearly_thm - first(yearly_thm)) / yearly_thm) * 100)
df_gas_hi <- df_gas_hi %>%
mutate(pct_change = ((yearly_thm - first(yearly_thm)) / yearly_thm) * 100)
df_elec_low <- df_elec_low %>%
mutate(pct_change = ((yearly_kwh - first(yearly_kwh)) / yearly_kwh) * 100)
df_elec_med <- df_elec_med %>%
mutate(pct_change = ((yearly_kwh - first(yearly_kwh)) / yearly_kwh) * 100)
# store tibbles in list
perc_changes <- list("gas_med" = df_gas_med,
"gas_high" = df_gas_hi,
"elec_low" = df_elec_low,
"elec_med" = df_elec_med)
View(perc_changes)
View(perc_changes[["gas_med"]])
View(perc_changes)
View(perc_changes[["gas_med"]])
# store tibbles in list
perc_change <- list("gas_med" = df_gas_med,
"gas_high" = df_gas_hi,
"elec_low" = df_elec_low,
"elec_med" = df_elec_med)
rm(list = ls()) # Clear RStudio environment
cat("\014") # Clear console
library(tidyverse)
# Drive: https://drive.google.com/file/d/1gJlrrCgolHX2Wh0akq6conA5PlvI8msb/view?usp=sharing
# Store values in vectors
el_values <- c(0, 1, 2, 3, 4, 5)
gas_med_uef <- c(0.58, 0.60, 0.64, 0.65, 0.75, 0.81)
gas_med_btu <- c(17.2, 16.7, 15.5, 15.0, 12.9, 11.9) # in Millions BTU (MMBTU)
gas_med_thm <- gas_med_btu * 10 # convert MMBTU to therms
gas_hi_uef <- c(0.63, 0.64, 0.68, 0.69, 0.80, 0.86)
gas_hi_btu <- c(19.9, 19.4, 18.1, 17.6, 15.1, 14.0)
gas_hi_thm <- gas_hi_btu * 10
elec_low_uef <- c(0.92, 0.93, 3.30, 3.70)
elec_low_kwh <- c(3073, 3047, 1206, 1134)
elec_med_uef <- c(0.92, 0.93, 3.35, 3.75)
elec_med_kwh <- c(3197, 3172, 1248, 1171)
# Data storage
df_gas_med <- tibble(el = el_values, uef = gas_med_uef, yearly_thm = gas_med_thm)
df_gas_hi <- tibble(el = el_values, uef = gas_hi_uef, yearly_thm = gas_hi_thm)
df_elec_low <- tibble(el = el_values[1:4], uef = elec_low_uef, yearly_kwh = elec_low_kwh)
df_elec_med <- tibble(el = el_values[1:4], uef = elec_med_uef, yearly_kwh = elec_med_kwh)
# calculate perc change in energy usage, by EL, for each draw pattern
df_gas_med <- df_gas_med %>%
mutate(pct_change = ((yearly_thm - first(yearly_thm)) / yearly_thm) * 100)
df_gas_hi <- df_gas_hi %>%
mutate(pct_change = ((yearly_thm - first(yearly_thm)) / yearly_thm) * 100)
df_elec_low <- df_elec_low %>%
mutate(pct_change = ((yearly_kwh - first(yearly_kwh)) / yearly_kwh) * 100)
df_elec_med <- df_elec_med %>%
mutate(pct_change = ((yearly_kwh - first(yearly_kwh)) / yearly_kwh) * 100)
# store tibbles in list
perc_change <- list("gas_med" = df_gas_med,
"gas_high" = df_gas_hi,
"elec_low" = df_elec_low,
"elec_med" = df_elec_med)
View(perc_change)
View(perc_change[["gas_med"]])
View(perc_change[["gas_high"]])
View(perc_change[["elec_low"]])
View(perc_change[["elec_med"]])
View(perc_change)
View(perc_change[["gas_med"]])
# Data storage
df_gas_med <- tibble(el = el_values, uef = gas_med_uef, yearly_thm = gas_med_thm)
View(perc_change)
View(perc_change[["gas_med"]])
View(perc_change[["gas_high"]])
View(perc_change[["gas_med"]])
View(perc_change[["gas_high"]])
View(perc_change[["elec_low"]])
View(perc_change[["elec_med"]])
library(shiny); runApp('Documents/Harris/4_FA22/Data and Programming - R II/week 4/lab 7.R')
runApp('Documents/Harris/4_FA22/Data and Programming - R II/week 4/lab 7.R')
setwd("~/Desktop/tech_adoption/data-build")
getwd()
setwd("~/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build")
getwd()
setwd("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build")
path <- /Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build
path <- Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build"
setwd("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build")
tidyverse()
library(tidyverse)
library(haven)
setwd("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build")
?read_dta()
read_dta(file.path(path, "atus-activity-summary-2021.dat")
read_dta(file.path(path, "atus-activity-summary-2021.dat"))
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build"
read_dta("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build/atus-activity-summary-2021.dat"))
read_dta("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build/atus-activity-summary-2021.dat")
read_dta("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build/atus-activity-summary-2021.dat")
read_dta("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-raw/atus-activity-summary-2021.dat")
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build"
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build"
read_dta(file.path(path, "atus-activity-summary-2021.dat")
read_dta(file.path(path, "atus-activity-summary-2021.dat"))
read_dta("Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build/atus-activity-summary-2021.dat")
setwd("/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build")
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build"
read_dta("Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project/data-build/atus-activity-summary-2021.dat")
read_dta("atus-activity-summary-2021.dat")
read_sas("atus-activity-summary-2021.sas")
library(haven)
atus_activity_summary_2021 <- read_sas("atus-activity-summary-2021.sas",
NULL)
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project"
read_csv(file.path(path, "/data-raw/atusact.csv"))
atus <- read_csv(file.path(path, "/data-raw/atusact.csv"))
View(atus)
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("case_id" <- tucaseid,
"actv_num" <- tuactivity_n,
"actv_dur" <- tuactdur24)
atus <- read_csv(file.path(path, "/data-raw/atusact.csv"))
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("case_id" <- tucaseid,
"actv_num" <- tuactivity_n,
"actv_dur" <- tuactdur24)
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24)
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("case_id" <- tucaseid,
"actv_num" <- tuactivity_n,
"actv_dur" <- tuactdur24)
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("case_id" <- tucaseid,
"actv_num" <- tuactivity_n,
"actv_dur" <- tuactdur24)
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("actv_num" <- tuactivity_n,
"actv_dur" <- tuactdur24)
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("case_id" = tucaseid,
"actv_num" = tuactivity_n,
"actv_dur" = tuactdur24)
atus <- read_csv(file.path(path, "/data-raw/atusact.csv"))
atus <- atus %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("case_id" = tucaseid,
"actv_num" = tuactivity_n,
"actv_min" = tuactdur24)
scinum(9999)
atus_raw <- read_csv(file.path(path, "/data-raw/atusact.csv"))
# only columns for id, activity, duration
atus <- atus_raw %>%
select(tucaseid, tuactivity_n, tuactdur24) %>%
rename("case_id" = tucaseid,
"actv_num" = tuactivity_n,
"actv_min" = tuactdur24)
View(atus_raw)
atus <- atus_raw %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur, tuactdur24, tucumdur, tucumdur24)
# only columns for id, activity, duration
atus <- atus_raw %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur, tuactdur24, tucumdur, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_line" = tuactivity_n,
"actv_code" = trcodep,
"dur" = tactdur,
"dur_24" = tuactdur24,
"cum_dur" = tucumdur,
"cum_dur_24" = tucumdur24)
# only columns for id, activity, duration
atus <- atus_raw %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur, tuactdur24, tucumdur, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_line" = tuactivity_n,
"actv_code" = trcodep,
"dur" = tuactdur,
"dur_24" = tuactdur24,
"cum_dur" = tucumdur,
"cum_dur_24" = tucumdur24)
atus <- atus %>%
filter(actv_code == 120304, 120305)
atus <- atus %>%
filter(actv_code == 120304 && 120305)
atus <- atus %>%
filter(actv_code == 120304 | 120305)
# only columns for activity identity and duration
atus <- atus_raw %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur, tuactdur24, tucumdur, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_line" = tuactivity_n,
"actv_code" = trcodep,
"dur" = tuactdur,
"dur_24" = tuactdur24,
"cum_dur" = tucumdur,
"cum_dur_24" = tucumdur24)
atus <- atus %>%
filter(actv_code == 120304 | 120305)
atus <- atus %>%
filter(actv_code == 130124 | 10201)
atus <- atus %>%
filter(actv_code = 130124 | 10201)
atus <- atus %>%
filter(actv_code == 130124 | 10201)
atus %>%
filter(actv_code == 130124 | 10201)
atus <- atus %>%
filter(actv_code == "130124" | "10201")
atus %>%
filter(actv_code == "130124" | "10201")
atus <- atus %>%
filter(actv_code == "130124" |
actv_code == "10201")
codes <- c("130124", # television and movies (not religious)
"120306", # listening to the radio
"120308", # computer use for leisure
"160101", # telephone calls to/from family members
"160102", # telephone calls to/from friends, neighbors, acquantances
)
codes <- c("130124", # television and movies (not religious)
"120304", # television (religious)
"120306", # listening to the radio
"120306", # listening to/playing music (not radio)
"120307", # playing games
"120308", # computer use for leisure
"160101", # telephone calls to/from family members
"160102" # telephone calls to/from friends, neighbors, acquantances
)
atus %>%
filter(actv_codes %in% codes)
atus %>%
filter(actv_code %in% codes)
atus <- atus %>%
filter(actv_code %in% codes)
# only columns for activity identity and duration
atus <- atus_raw %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur, tuactdur24, tucumdur, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_line" = tuactivity_n,
"actv_code" = trcodep,
"dur" = tuactdur,
"dur_24" = tuactdur24,
"cum_dur" = tucumdur,
"cum_dur_24" = tucumdur24)
atus <- atus %>%
filter(actv_code %in% codes)
# only columns for activity identity and duration
atus <- atus_raw %>%
select(tucaseid, trcodep, tuactdur, tuactdur24, tucumdur, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_code" = trcodep,
"dur" = tuactdur,
"dur_24" = tuactdur24,
"cum_dur" = tucumdur,
"cum_dur_24" = tucumdur24)
# only activities related to technology and attention
atus <- atus %>%
filter(actv_code %in% codes)
View(atus)
# only columns for activity identity and duration
atus <- atus_raw %>%
select(tucaseid, trcodep, tuactdur24, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_code" = trcodep,
"day_dur" = tuactdur24,
"cum_dur" = tucumdur24)
# only activities related to technology and attention
atus <- atus %>%
filter(actv_code %in% codes)
View(atus)
options(scipen=9999)
View(atus)
atus_day <- atus %>%
select(!tucumdur24)
atus_day <- atus %>%
select(!cum_dur) %>%
atus_day <- atus %>%
select(!cum_dur)
atus_day <- atus %>%
select(-cum_dur)
atus_day <- atus %>%
select(-cum_dur) %>%
pivot_wider(names_from = actv_code, values_from = day_dur)
View(atus_day)
View(atus)
atus_act_raw <- read_csv(file.path(path, "/data-raw/atusact.csv"))
atus_cps_raw <- read_csv(file.path(path, "/data-raw/atuscps.csv"))
# only columns for activity identity and duration
atus_act <- atus_act_raw %>%
select(tucaseid, trcodep, tuactdur24, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_code" = trcodep,
"day_dur" = tuactdur24,
"cum_dur" = tucumdur24)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
View(atus_act)
View(atus_cps_raw)
# merge with cps
# clean cps
atus_cps <- atus_cps_raw %>%
select(tucaseid, prtage, pesex)
raw_atus_act <- read_csv(file.path(path, "/data-raw/atusact.csv"))
path <- "/Users/lindsayhiser/Documents/Harris/4_FA22/Data Visualization/CAPP30239_FA22/final_project"
raw_atus_act <- read_csv(file.path(path, "/data-raw/atusact.csv"))
raw_atus_cps <- read_csv(file.path(path, "/data-raw/atuscps.csv"))
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, trcodep, tuactdur24, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_code" = trcodep,
"day_dur" = tuactdur24,
"cum_dur" = tucumdur24)
codes <- c("130124", # television and movies (not religious)
"120304", # television (religious)
"120306", # listening to the radio
"120306", # listening to/playing music (not radio)
"120307", # playing games
"120308", # computer use for leisure
"160101", # telephone calls to/from family members
"160102" # telephone calls to/from friends, neighbors, acquantances
)
# merge with cps
# clean cps
atus_cps <- raw_atus_cps %>%
select(tucaseid, prtage, pesex)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
View(atus_act)
View(atus_cps)
View(raw_atus_act)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24, tucumdur24) %>%
rename("case_id" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"day_dur" = tuactdur24,
"cum_dur" = tucumdur24)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("case_id" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"day_dur" = tuactdur24)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("case" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"min" = tuactdur24)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("case" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# only activities related to technology and attention
atus_act %>%
filter(actv_code %in% codes) %>%
group_by(respondent, actv_code) %>%
summarise(tot_min = sum(minutes))
atus_act %>%
filter(actv_code %in% codes)
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes)
atus_act %>%
group_by(respondent, actv_code) %>%
summarise(tot_min = sum(minutes))
# only activities related to technology and attention
atus_act <- atus_act %>%
filter(actv_code %in% codes) %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes))
atus_act <- actus_act %>%
filter(actv_code %in% codes)
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# combine times for multiple instances of single activity
atus_act <- atus_act %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes))
atus_act %>%
pivot_wider(names_from = actv_code, values_from = minutes)
atus_act <- atus_act %>%
pivot_wider(names_from = actv_code, values_from = minutes)
# filter activities
codes <- c("120303", # television and movies (not religious)
"120304", # television (religious)
"120305", # listening to the radio
"120306", # listening to/playing music (not radio)
"120307", # playing games
"120308", # computer use for leisure
"160101", # telephone calls to/from family members
"160102" # telephone calls to/from friends, neighbors, acquantances
)
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# combine times for multiple instances of single activity
atus_act <- atus_act %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes) %>%
rename("tv_movies" = "120303",
"tv_relig" = "120304",
"radio" = "120305",
"music" = "120306",
"games" = "120307",
"computer" = "120308",
"phone_family" = "160101",
"phone_friends" = "160102")
# clean act
atus_act <- raw_atus_act %>%
select(tucaseid, tuactivity_n, trcodep, tuactdur24) %>%
rename("respondent" = tucaseid,
"actv_num" = tuactivity_n,
"actv_code" = trcodep,
"minutes" = tuactdur24)
# filter activities
codes <- c("120303", # television and movies (not religious)
"120304", # television (religious)
"120305", # listening to the radio
"120306", # listening to/playing music (not radio)
"120307", # playing games
"120308", # computer use for leisure
"160101", # telephone calls to/from family members
"160102" # telephone calls to/from friends, neighbors, acquantances
)
atus_act <- atus_act %>%
filter(actv_code %in% codes)
# combine times for multiple instances of single activity
atus_act <- atus_act %>%
group_by(respondent, actv_code) %>%
summarise(minutes = sum(minutes)) %>%
pivot_wider(names_from = actv_code, values_from = minutes) %>%
rename("tv_movies" = "120303",
"tv_relig" = "120304",
"radio" = "120305",
"music" = "120306",
"games" = "120307",
"computer" = "120308",
"phone_family" = "160101",
"phone_friends" = "160102")
View(atus_cps)
View(raw_atus_act)
